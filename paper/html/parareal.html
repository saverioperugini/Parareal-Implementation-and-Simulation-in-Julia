<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" 
"http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd" > 
<html xmlns="http://www.w3.org/1999/xhtml"  
> 
<head><title>PARAREAL ALGORITHM IMPLEMENTATION AND SIMULATION IN
JULIA</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<!-- xhtml,mathml,charset=utf-8,html --> 
<meta name="src" content="parareal.tex" /> 
<link rel="stylesheet" type="text/css" href="parareal.css" /> 
</head><body 
>
   <div class="maketitle">
                                                                            

                                                                            
                                                                            

                                                                            

<h2 class="titleHead">PARAREAL ALGORITHM IMPLEMENTATION AND
SIMULATION IN JULIA</h2>
<div class="author" >Tyler M. Masthay and Saverio Perugini
<br />   Department of Computer Science
<br />         University of Dayton
<br />           300 College Park
<br />      Dayton, Ohio  45469–2160
<br />            (937) 229–4079
<br />   <span 
class="cmsy-10x-x-120">{</span>tmasthay1,saverio<span 
class="cmsy-10x-x-120">}</span>@udayton.edu</div><br />
<div class="date" ></div>
   </div>
   <div 
class="abstract" 
>
<div class="center" 
>
<!--l. 56--><p class="noindent" >
</p><!--l. 56--><p class="noindent" ><span 
class="cmbx-10x-x-109">ABSTRACT</span></p></div>
      <!--l. 56--><p class="indent" >    <span 
class="cmr-10x-x-109">We  present  a  full  implementation  of  the  </span><span 
class="cmti-10x-x-109">parareal  algorithm</span><span 
class="cmr-10x-x-109">—an</span>
      <span 
class="cmr-10x-x-109">integration  technique  to  solve  diﬀerential  equations  in  parallel—in</span>
      <span 
class="cmr-10x-x-109">the  Julia  programming  language  for  a  fully  general,  ﬁrst-order,</span>
      <span 
class="cmr-10x-x-109">initial-value problem. We provide a brief overview of Julia—a concurrent</span>
      <span 
class="cmr-10x-x-109">programming language for scientiﬁc computing. Our implementation</span>
      <span 
class="cmr-10x-x-109">of the </span><span 
class="cmti-10x-x-109">parareal algorithm </span><span 
class="cmr-10x-x-109">accepts both coarse and ﬁne integrators as</span>
      <span 
class="cmr-10x-x-109">functional arguments. We use </span><span 
class="cmti-10x-x-109">Euler&#x2019;s method </span><span 
class="cmr-10x-x-109">and another </span><span 
class="cmti-10x-x-109">Runge-Kutta</span>
      <span 
class="cmr-10x-x-109">integration technique as the integrators in our experiments. We also</span>
      <span 
class="cmr-10x-x-109">present a simulation of the algorithm for purposes of pedagogy and as</span>
      <span 
class="cmr-10x-x-109">a tool for investigating the performance of the algorithm.</span>
</p>
</div>
                                                                            

                                                                            
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>INTRODUCTION</h3>
<!--l. 71--><p class="noindent" >The <span 
class="cmti-12">parareal algorithm </span>was ﬁrst proposed in 2001 by Lions, Maday, and Turinici <span class="cite">[<a 
href="#XLionsEtAl">7</a>]</span>
as an integration technique to solve diﬀerential equations in parallel. We present a
full implementation of the parareal algorithm in the Julia programming language
(<a 
href="https://julialang.org" class="url" ><span 
class="cmtt-12">https://julialang.org</span></a>) <span class="cite">[<a 
href="#XJulia">8</a>]</span> for a fully general, ﬁrst-order, initial-value
problem. Furthermore, we present a simulation of the algorithm for purposes of
pedagogy and as a tool for investigating the performance of the algorithm. Our
implementation accepts both coarse and ﬁne integrators as functional arguments.
We use <span 
class="cmti-12">Euler&#x2019;s method </span>and another <span 
class="cmti-12">Runge-Kutta </span>integration technique as the
integrators in our experiments. We start with a brief introduction to the Julia
proramming language.
</p><!--l. 86--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-2000"></a>AN INTRODUCTION TO JULIA: DYNAMIC, YET EFFICIENT SCIENTIFIC/NUMERICAL PROGRAMMING</h3>
<!--l. 88--><p class="noindent" >Julia is a multi-paradigm language designed for scientiﬁc computing which supports
multidimensional arrays, concurrency, and metaprogramming. Due to both Julia&#x2019;s
LLVM-based Just-In-Time (JIT) compiler and the language design, Julia programs
run computationally eﬃcient—approaching and sometimes matching the speed of
languages like C. See <span class="cite">[<a 
href="#Xwebsite">1</a>]</span> for a graph depicting the relative performance of Julia
compared to other common languages for scientiﬁc computing on a set of
micro-benchmarks.
</p><!--l. 104--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-3000"></a>Coroutines and CSP in Julia</h4>
<!--l. 108--><p class="noindent" >Coroutines are typically referred to as <span 
class="cmti-12">tasks </span>in Julia, and are not scheduled to run
on separate CPU cores. Channels in Julia can be either synchronous or
asynchronous, and can be typed. However, if no type is speciﬁed in the deﬁnition of
the channel, then values of any types can be written to that channel, much like
<span 
class="cmcsc-10x-x-120"><span 
class="small-caps">u</span><span 
class="small-caps">n</span><span 
class="small-caps">i</span><span 
class="small-caps">x</span> </span>pipes.
</p><!--l. 114--><p class="noindent" >Messages are passed between coroutines through channels with the <span 
class="cmtt-12">put! </span>and
<span 
class="cmtt-12">take!() </span>functions. To add tasks to be automatically scheduled, use the
<span 
class="cmtt-12">schedule() </span>function, or the <span 
class="cmtt-12">@schedule </span>and <span 
class="cmtt-12">@sync </span>macros. Of course, coroutines
have little overhead, but will always run on the same <span 
class="cmcsc-10x-x-120"><span 
class="small-caps">c</span><span 
class="small-caps">p</span><span 
class="small-caps">u</span></span>.
                                                                            

                                                                            
</p><!--l. 123--><p class="indent" >
      </p><div class="quote">
      <!--l. 124--><p class="noindent" >The current version of Julia multiplexes all tasks onto a single <span 
class="cmcsc-10x-x-120"><span 
class="small-caps">o</span><span 
class="small-caps">s</span></span>
      thread. Thus, while tasks involving <span 
class="cmcsc-10x-x-120"><span 
class="small-caps">i</span>/<span 
class="small-caps">o</span> </span>operations beneﬁt from
      parallel execution, compute bound tasks are eﬀectively executed
      sequentially on a single <span 
class="cmcsc-10x-x-120"><span 
class="small-caps">o</span><span 
class="small-caps">s</span> </span>thread. Future versions of Julia may
      support  scheduling  of  tasks  on  multiple  threads,  in  which  case
      compute bound tasks will enjoy the beneﬁts of parallel execution
      as well <span class="cite">[<a 
href="#XJuliaParallelComputingMan">2</a>]</span>.</p></div>
<!--l. 134--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-4000"></a>Parallel Computing</h4>
<!--l. 137--><p class="noindent" >In addition to tasks, Julia supports parallel computing—functions running on
distributed computers, or multiple <span 
class="cmcsc-10x-x-120"><span 
class="small-caps">c</span><span 
class="small-caps">p</span><span 
class="small-caps">u</span></span>s. New processes are spawned with
<span 
class="cmtt-12">addproc(</span><!--l. 141--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">n</span><!--l. 141--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math><span 
class="cmtt-12">)</span>,
where
<!--l. 142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">n</span><!--l. 142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math>
is the number of processes desired. The function <span 
class="cmtt-12">addproc </span>returns the
<span 
class="cmcsc-10x-x-120"><span 
class="small-caps">p</span><span 
class="small-caps">i</span><span 
class="small-caps">d</span></span>s of the created processes. The function <span 
class="cmtt-12">workers </span>returns a list of the
processes. Alternatively, the Julia interpreter can be started with the <span 
class="cmtt-12">-p</span>
<!--l. 146--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">n</span><!--l. 146--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math>
option,  where
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">n</span><!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math>
is the number of processes desired. For instance:
</p>
   <!--l. 150-->
   <div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-4001r1"></a></span><span 
class="cmr-8">$</span><span 
class="cmr-8"> </span><span 
class="cmr-8">julia</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4002r2"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">addprocs</span><span 
class="cmr-8">(3)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4003r3"></a></span><span 
class="cmr-8">3</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">element</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Array</span><span 
class="cmsy-8">{</span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">,1</span><span 
class="cmsy-8">}</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4004r4"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">2</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4005r5"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">3</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4006r6"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">4</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4007r7"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4008r8"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">workers</span><span 
class="cmr-8">()</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4009r9"></a></span><span 
class="cmr-8">3</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">element</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Array</span><span 
class="cmsy-8">{</span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">,1</span><span 
class="cmsy-8">}</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4010r10"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">2</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4011r11"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">3</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4012r12"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">4</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4013r13"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4014r14"></a></span><span 
class="cmr-8">ˆ</span><span 
class="cmr-8">D</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4015r15"></a></span><span 
class="cmr-8">$</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4016r16"></a></span><span 
class="cmr-8">$</span><span 
class="cmr-8"> </span><span 
class="cmr-8">julia</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">−</span><span 
class="cmr-8">p</span><span 
class="cmr-8"> </span><span 
class="cmr-8">3</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4017r17"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">workers</span><span 
class="cmr-8">()</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4018r18"></a></span><span 
class="cmr-8">3</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">element</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Array</span><span 
class="cmsy-8">{</span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">,1</span><span 
class="cmsy-8">}</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4019r19"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">2</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4020r20"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">3</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4021r21"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">4</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4022r22"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4023r23"></a></span><span 
class="cmr-8">ˆ</span><span 
class="cmr-8">D</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4024r24"></a></span><span 
class="cmr-8">$</span>
   
   </div>
<!--l. 177--><p class="noindent" >Note that the process ids start at 2 because the Julia REPL shell is process
1.
</p><!--l. 180--><p class="indent" >   Processes in Julia which are either locally running or remotely distributed,
communicate with each other through message passing.
</p><!--l. 183--><p class="indent" >   The  function
<span 
class="cmtt-12">remotecall(</span><!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">Function</span><!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math><span 
class="cmtt-12">,</span> <!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">ProcessID</span><!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math><span 
class="cmtt-12">,</span> <!--l. 184--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">args</span>
                                                                            

                                                                            
<span 
class="cmtt-12">…</span><!--l. 185--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math><span 
class="cmtt-12">) </span>executes
<!--l. 186--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">Function</span><!--l. 186--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math>
on  worker
<!--l. 187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">ProcessID</span><!--l. 187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math>
and returns a value of the <span 
class="cmtt-12">Future </span>type, which contains a reference
to a location from which the return value can be retrieved, once
<!--l. 190--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">Function</span><!--l. 190--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math>
has completed its execution. The <span 
class="cmtt-12">Future </span>value can be extracted with the function
<span 
class="cmtt-12">fetch()</span>, which blocks until the result is available. Thus, the function <span 
class="cmtt-12">remotecall</span>
is used to send a message while the function <span 
class="cmtt-12">fetch </span>is used to receive a message. For
instance:
</p>
   <!--l. 198-->
   <div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-4025r1"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">addprocs</span><span 
class="cmr-8">(2)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4026r2"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">future</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">remotecall</span><span 
class="cmr-8">(</span><span 
class="cmbx-8">sqrt</span><span 
class="cmr-8">,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">2,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">4)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4027r3"></a></span><span 
class="cmr-8">Future</span><span 
class="cmr-8">(2,1,3,</span><span 
class="cmr-8">Nullable</span><span 
class="cmsy-8">{</span><span 
class="cmr-8">Any</span><span 
class="cmsy-8">}</span><span 
class="cmr-8">())</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4028r4"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fetch</span><span 
class="cmr-8">(</span><span 
class="cmr-8">future</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4029r5"></a></span><span 
class="cmr-8">2.0</span>
   
   </div>
<!--l. 206--><p class="noindent" >After the function <span 
class="cmtt-12">remotecall </span>is run, the worker process simply waits for the next
call to <span 
class="cmtt-12">remotecall</span>.
</p>
   <!--l. 210-->
   <div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-4030r1"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">counter1</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">new</span><span 
class="cmr-8">_counter</span><span 
class="cmr-8">(3)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4031r2"></a></span><span 
class="cmr-8">(::#1)</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">generic</span><span 
class="cmr-8"> </span><span 
class="cmbx-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">with</span><span 
class="cmr-8"> </span><span 
class="cmr-8">1</span><span 
class="cmr-8"> </span><span 
class="cmr-8">method</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4032r3"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">future</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">remotecall</span><span 
class="cmr-8">(</span><span 
class="cmr-8">counter1</span><span 
class="cmr-8">,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">2)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4033r4"></a></span><span 
class="cmr-8">Future</span><span 
class="cmr-8">(2,1,23,</span><span 
class="cmr-8">Nullable</span><span 
class="cmsy-8">{</span><span 
class="cmr-8">Any</span><span 
class="cmsy-8">}</span><span 
class="cmr-8">())</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4034r5"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fetch</span><span 
class="cmr-8">(</span><span 
class="cmr-8">future</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4035r6"></a></span><span 
class="cmr-8">4</span>
   
   </div>
<!--l. 219--><p class="noindent" >The Julia macro <span 
class="cmtt-12">@spawn </span>simpliﬁes this message-passing protocol for the
programmer and obviates the need for explicit use of the low-level <span 
class="cmtt-12">remotecall</span>
function. Similarly, the macro <span 
class="cmtt-12">@parallel </span>can be used to run each iteration of a
(for) loop in its own process.
</p>
   <!--l. 225-->
   <div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-4036r1"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">future</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">@spawn</span><span 
class="cmr-8"> </span><span 
class="cmbx-8">sqrt</span><span 
class="cmr-8">(4)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4037r2"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fetch</span><span 
class="cmr-8">(</span><span 
class="cmr-8">future</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4038r3"></a></span><span 
class="cmr-8">2.0</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4039r4"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">addprocs</span><span 
class="cmr-8">(2)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4040r5"></a></span><span 
class="cmr-8">2</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">element</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Array</span><span 
class="cmsy-8">{</span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">,1</span><span 
class="cmsy-8">}</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4041r6"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">3</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4042r7"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8">4</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4043r8"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">@everywhere</span><span 
class="cmr-8"> </span><span 
class="cmbx-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4044r9"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">if</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8"> </span><span 
class="cmmi-8">&#x003C;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">2)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4045r10"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">n</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4046r11"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">else</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4047r12"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1)</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">2)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4048r13"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4049r14"></a></span><span 
class="cmbx-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4050r15"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">@everywhere</span><span 
class="cmr-8"> </span><span 
class="cmbx-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">_parallel</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4051r16"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">if</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8"> </span><span 
class="cmmi-8">&#x003C;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">35)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4052r17"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4053r18"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">else</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4054r19"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">x</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">@spawn</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">_parallel</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4055r20"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">y</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">_parallel</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">2)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4056r21"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fetch</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">y</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4057r22"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmbx-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4058r23"></a></span><span 
class="cmbx-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4059r24"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">@time</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">(42)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4060r25"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">2.271563</span><span 
class="cmr-8"> </span><span 
class="cmr-8">seconds</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(793</span><span 
class="cmr-8"> </span><span 
class="cmr-8">allocations</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><span 
class="cmr-8">40.718</span><span 
class="cmr-8"> </span><span 
class="cmr-8">KB</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4061r26"></a></span><span 
class="cmr-8">267914296</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4062r27"></a></span><span 
class="cmr-8">julia</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">@time</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fib</span><span 
class="cmr-8">_parallel</span><span 
class="cmr-8">(42)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4063r28"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">3.483601</span><span 
class="cmr-8"> </span><span 
class="cmr-8">seconds</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(344.48</span><span 
class="cmr-8"> </span><span 
class="cmr-8">k</span><span 
class="cmr-8"> </span><span 
class="cmr-8">allocations</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-4064r29"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">15.344</span><span 
class="cmr-8"> </span><span 
class="cmr-8">MB</span><span 
class="cmr-8">,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">0.25</span><span 
class="cmti-8">%</span><span 
class="cmti-8"> </span><span 
class="cmti-8">gc</span><span 
class="cmti-8"> </span><span 
class="cmti-8">time</span><span 
class="cmti-8">)</span>
   
   </div>
<!--l. 257--><p class="noindent" >There are also remote channels which are writable for more control over
synchronizing processes.
</p><!--l. 261--><p class="indent" >   It can accept a user-deﬁned function that performs the computation in
parallel <span class="cite">[<a 
href="#XPPPP:Julia">5</a>]</span>.
</p><!--l. 268--><p class="noindent" >
                                                                            

                                                                            
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-5000"></a>Multidimensional Arrays</h4>
<!--l. 270--><p class="noindent" >Julia supports multidimensional arrays, which are an important data structure in
scientiﬁc computing applications, with a simple syntax and their eﬃcient
creation and interpretation over many dimensions <span class="cite">[<a 
href="#XOperators:Julia">4</a>]</span>. The function call
<span 
class="cmtt-12">ArrayType(</span><!--l. 274--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003C;</mi></math><span 
class="cmitt-10x-x-120">dimensions</span><!--l. 274--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi mathvariant="monospace">&#x003E;</mi></math><span 
class="cmtt-12">)</span>
creates an array, where the <!--l. 275--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mi mathvariant="normal">th</mi></mrow></msup 
></math>
argument in dimensions speciﬁes the size of the
<!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>n</mi></mrow><mrow 
><mi mathvariant="normal">th</mi></mrow></msup 
></math>
dimension of the array. Similarly, the programmer manipulates these arrays using
function calls that support inﬁnite-dimensional arrays given only limitations
on computational time. In summary, Julia incorporates concepts and
mechanisms—particularly concurrency and multidimensional arrays—which
support eﬃcient scientiﬁc computing.
</p><!--l. 282--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-6000"></a>THE PARAREAL ALGORITHM</h3>
   <hr class="figure" /><div class="figure" 
>
                                                                            

                                                                            
<a 
 id="x1-60011"></a>
                                                                            

                                                                            
<!--l. 286--><p class="noindent" ><img 
src="error.png" alt="PIC"  
 />
<br /> </p><div class="caption" 
><span class="id">Figure 1: </span><span  
class="content">Right endpoint error.</span></div><!--tex4ht:label?: x1-60011 -->
                                                                            

                                                                            
   </div><hr class="endfigure" />
<!--l. 291--><p class="indent" >   The parareal algorithm is designed to perform parallel-in-time integration for a
ﬁrst-order initial-value problem. The algorithm involves two integration techniques,
often known as the ‘coarse&#x2019; integrator and the ‘ﬁne&#x2019; integrator. For the
algorithm to be eﬀective, the coarse integrator must be of substantially
lower computational cost than the ﬁne integrator. The reason will
become apparent later in this section. Consider the diﬀerential equation
<!--l. 297--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="textup" mathvariant="normal" >(</mtext><mtext 
 xlink:type="simple" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#x1-6002r1"  class="label" >1<!--tex4ht:ref: ode --></mtext><mtext 
class="endlabel">)</mtext></mstyle></math> given
by
</p>
   <table class="equation"><tr><td> <a 
 id="x1-6002r1"></a>
<!--l. 299--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>f</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>t</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mspace width="1em" class="quad"/><mi 
>t</mi> <mo 
class="MathClass-rel">∈</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">]</mo></mrow>
</math></td><td class="eq-no">(1)</td></tr></table>
<!--l. 303--><p class="noindent" >with its associated initial-value problem
<!--l. 304--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="textup" mathvariant="normal" >(</mtext><mtext 
 xlink:type="simple" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#x1-6003r2"  class="label" >2<!--tex4ht:ref: ivp --></mtext><mtext 
class="endlabel">)</mtext></mstyle></math> </p><table class="equation"><tr><td>
<a 
 id="x1-6003r2"></a>
<!--l. 305--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                            <mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>t</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mspace width="1em" class="quad"/><msup><mrow 
><mi 
>t</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
> <mo 
class="MathClass-rel">∈</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mi mathvariant="normal">.</mi>
</math></td><td class="eq-no">(2)</td></tr></table>
<!--l. 309--><p class="noindent" >For simplicity, let us assume <!--l. 309--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>t</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>a</mi></math>,
so that the solution only extends rightward. To obtain an approximate solution to
equation <!--l. 310--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="textup" mathvariant="normal" >(</mtext><mtext 
 xlink:type="simple" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#x1-6002r1"  class="label" >1<!--tex4ht:ref: ode --></mtext><mtext 
class="endlabel">)</mtext></mstyle></math> satisfying the
initial condition <!--l. 311--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="textup" mathvariant="normal" >(</mtext><mtext 
 xlink:type="simple" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#x1-6003r2"  class="label" >2<!--tex4ht:ref: ivp --></mtext><mtext 
class="endlabel">)</mtext></mstyle></math>, we
partition our domain into <!--l. 312--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>a</mi><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>N</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>b</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
                                                                            

                                                                            
with uniform step size <!--l. 312--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Δ</mi></math>.
We now precisely deﬁne an ‘integrator&#x2019; as a function from
<!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><mn>0</mn><mo 
class="MathClass-punc">,</mo><mi 
>∞</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-bin">×</mo> <msup><mrow 
><mi 
>ℝ</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
> <mo 
class="MathClass-bin">×</mo><mi 
>ℛ</mi></math> to
<!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℝ</mi></math> where
<!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℛ</mi></math> is
the set of all Riemann integrable functions. For example, the integrator
<!--l. 313--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi></math> given
by </p><table class="equation-star"><tr><td>
<!--l. 314--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                       <mi 
>I</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>δ</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>g</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-bin">+</mo> <mi 
>g</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>x</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow><mi 
>δ</mi>
</math></td></tr></table>
<!--l. 318--><p class="noindent" >is the integrator corresponding to Euler&#x2019;s method with step size
<!--l. 319--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>δ</mi></math>. Let
<!--l. 320--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>𝒞</mi></math> and
<!--l. 320--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ℱ</mi></math> be
the coarse and ﬁne integrators, respectively. Deﬁne
</p><!--tex4ht:inline--><!--l. 325--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                     <mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>0</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></mtd>                       <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mspace width="2em"/></mtd>                                     <mtd 
columnalign="right" class="align-label"></mtd>                     <mtd 
class="align-label">
                     <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></mtd>                     <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>𝒞</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Δ</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>f</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mi mathvariant="normal">.</mi><mspace width="2em"/></mtd>                     <mtd 
columnalign="right" class="align-label"></mtd>                     <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
                                                                            

                                                                            
<!--l. 327--><p class="noindent" >Since <!--l. 328--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></math>
depends on <!--l. 328--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></math>,
this algorithm is inherently sequential. Partition
<!--l. 329--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow></math> into
<!--l. 330--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>0</mn></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>t</mi></mrow><mrow 
>
<mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow><mrow 
><mi 
>m</mi></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
>
<mi 
>n</mi></mrow><mrow 
><mi 
>M</mi></mrow></msubsup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>t</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> with uniform
step size <!--l. 330--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>δ</mi> <mo 
class="MathClass-rel">&#x003C;</mo> <mi 
>Δ</mi></math>.
Deﬁne
</p><!--tex4ht:inline--><!--l. 334--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                     <mtr><mtd 
columnalign="right" class="align-odd"><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mn>0</mn></mrow></msubsup 
></mtd>                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
>
<mi 
>n</mi></mrow><mrow 
><mn>0</mn></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
><mspace width="2em"/></mtd>                                      <mtd 
columnalign="right" class="align-label"></mtd>                     <mtd 
class="align-label">
                     <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mi 
>m</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msubsup 
></mtd>                     <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
>
<mi 
>n</mi></mrow><mrow 
><mi 
>m</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msubsup 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>ℱ</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>δ</mi><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>t</mi></mrow><mrow 
>
<mi 
>n</mi></mrow><mrow 
><mi 
>m</mi></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mi 
>m</mi></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo><mi 
>f</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mi mathvariant="normal">.</mi><mspace width="2em"/></mtd>                     <mtd 
columnalign="right" class="align-label"></mtd>                     <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 336--><p class="noindent" >This yields an approximate solution <!--l. 337--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mn>0</mn></mrow></msubsup 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
>
<mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mi 
>M</mi></mrow></msubsup 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
to <!--l. 338--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext class="textup" mathvariant="normal" >(</mtext><mtext 
 xlink:type="simple" xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#x1-6002r1"  class="label" >1<!--tex4ht:ref: ode --></mtext><mtext 
class="endlabel">)</mtext></mstyle></math>
over <!--l. 338--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
with initial conditions
</p><!--tex4ht:inline--><!--l. 341--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                                <mtr><mtd 
columnalign="right" class="align-odd"><mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
><mi mathvariant="normal">.</mi></mtd>                                <mtd 
class="align-even"><mspace width="2em"/></mtd>                                <mtd 
columnalign="right" class="align-label">
   </mtd></mtr></mtable></math>
                                                                            

                                                                            
<!--l. 343--><p class="noindent" >Since <!--l. 343--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></mrow></msubsup 
></math> does not
depend on <!--l. 343--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><msub><mrow 
><mi 
>m</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></mrow></msubsup 
></math>
for <!--l. 343--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-rel">≠</mo><msub><mrow 
><mi 
>n</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math>,
we can compute these approximations in parallel. After the last
subproblem is solved, we simply combine the solutions on each subdomain
to obtain a solution over the whole interval. However, our values
<!--l. 346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">.</mo><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> are
relatively inaccurate. The vertical spikes in the orange graph separating
the coarse and ﬁne predictions in Figure <a 
href="#x1-60011">1<!--tex4ht:ref: errorIllustration --></a> illustrate this error. However,
<!--l. 349--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mi 
>M</mi></mrow></msubsup 
></math> is a better
approximation for <!--l. 350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
where <!--l. 351--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>ϕ</mi></math>
is the exact solution to the diﬀerential equation. We use this to obtain a better set
of points <!--l. 354--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
for the coarse approximation. We do this by ﬁrst deﬁning
<!--l. 354--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></math> and
then deﬁning
</p><!--tex4ht:inline--><!--l. 359--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                        <mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></mtd>                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mspace width="2em"/></mtd>                                <mtd 
columnalign="right" class="align-label"></mtd>                        <mtd 
class="align-label">
                        <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></mtd>                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>𝒞</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Δ</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>f</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mspace width="2em"/></mtd>                            <mtd 
columnalign="right" class="align-label"></mtd>                        <mtd 
class="align-label">
                        <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></mtd>                        <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mi 
>M</mi></mrow></msubsup 
><mi mathvariant="normal">.</mi><mspace width="2em"/></mtd>                        <mtd 
columnalign="right" class="align-label"></mtd>                        <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 360--><p class="noindent" >Thus, <!--l. 360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></math>
serves as a new prediction given a more accurate previous prediction from
<!--l. 360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></math> since
<!--l. 360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mn>1</mn></mrow><mrow 
><mi 
>M</mi></mrow></msubsup 
></math>
has now been taken into account in calculating
<!--l. 360--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mn>2</mn></mrow></msub 
></math>. In general, we continue
evaluating so that for <!--l. 361--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mn>1</mn></math>,
                                                                            

                                                                            
we have
</p><!--tex4ht:inline--><!--l. 366--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" ><mtable 
columnalign="left" class="align-star">
                      <mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
></mtd>                      <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mo 
class="MathClass-bin">∗</mo></mrow></msup 
><mspace width="2em"/></mtd>                                         <mtd 
columnalign="right" class="align-label"></mtd>                      <mtd 
class="align-label">
                      <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
></mtd>                      <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mi 
>𝒞</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Δ</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>k</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">,</mo><mi 
>f</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mspace width="2em"/></mtd>                            <mtd 
columnalign="right" class="align-label"></mtd>                      <mtd 
class="align-label">
                      <mspace width="2em"/></mtd></mtr><mtr><mtd 
columnalign="right" class="align-odd"><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
></mtd>                      <mtd 
class="align-even"> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-bin">+</mo> <msubsup><mrow 
><mi 
>z</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>k</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow><mrow 
><mi 
>M</mi></mrow></msubsup 
><mi mathvariant="normal">.</mi><mspace width="2em"/></mtd>                      <mtd 
columnalign="right" class="align-label"></mtd>                      <mtd 
class="align-label">
   <mspace width="2em"/></mtd></mtr></mtable></math>
<!--l. 368--><p class="noindent" >Note that since <!--l. 368--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
></math> is dependent
on <!--l. 368--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
></math>, this step must be
done sequentially. As <!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>
increases, <!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
> <mo 
class="MathClass-bin">−</mo> <msub><mrow 
><mi 
>w</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msub 
> <mo 
class="MathClass-rel">→</mo> <mn>0</mn></math>, which
means that <!--l. 370--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>n</mi><mo 
class="MathClass-punc">,</mo><mi 
>k</mi></mrow></msub 
></math>
converges to the value that the ﬁne integrator would predict
if ﬁne integration were simply done sequentially. Thus, each
<!--l. 371--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>
denotes ﬁne integration over the whole interval. This means that the total
computation performed is much greater than if ﬁne integration were performed
sequentially. However, the time eﬃciency of each iteration has the potential to be
improved through concurrency. Since ﬁne integration is more computationally
intensive, this improvement in the run-time eﬃciency may compensate for the
cumulative computation performed.
</p><!--l. 379--><p class="indent" >   Let <!--l. 379--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi></math>
be the total number of iterations necessary to achieve a desired accuracy of solution
and <!--l. 380--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi></math> be
the number of subintervals into which we divide according to the coarse integrator. If
<!--l. 381--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>, then we achieve perfect
parallel eﬃciency. If <!--l. 382--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>K</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>P</mi></math>,
then we likely slowed the computation down. The parareal algorithm is guaranteed
to converge to the solution given by the sequential ﬁne integrator within
<!--l. 384--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>P</mi></math>
                                                                            

                                                                            
iterations. For a more complete treatment of this convergence analysis, we
refer the reader to <span class="cite">[<a 
href="#XGander">6</a>]</span>. For fully general pseudocode, we refer the reader
to <span class="cite">[<a 
href="#XAubanel">3</a>, <a 
href="#XNielsen">9</a>]</span>.
</p>
   <h3 class="likesectionHead"><a 
 id="x1-7000"></a>PARAREAL ALGORITHM IMPLEMENTATION IN JULIA</h3>
   <!--l. 390-->
                                                                            

                                                                            
<!--l. 390--><p class="indent" >   <a 
 id="x1-7001r1"></a></p><hr class="float" /><div class="float" 
>
                                                                            

                                                                            
<a 
 id="x1-7002"></a>
    <div class="caption" 
><span class="id">Listing 1:     </span><span  
class="content">Implementation     of     the     parareal     algorithm     in
Julia.</span></div><!--tex4ht:label?: x1-7001r --><div class="lstlisting" id="listing-5"><span class="label"><a 
 id="x1-7003r1"></a></span><span 
class="cmr-8">@everywhere</span><span 
class="cmr-8"> </span><span 
class="cmr-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">parareal</span><span 
class="cmr-8">(</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">nC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">,</span><span 
class="cmr-8">K</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">,</span><span 
class="cmr-8">coarseIntegrator</span><span 
class="cmr-8">,</span><span 
class="cmr-8">fineIntegrator</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7004r2"></a></span><span 
class="cmr-8">#</span><span 
class="cmr-8">initialize</span><span 
class="cmr-8"> </span><span 
class="cmr-8">coarse</span><span 
class="cmr-8"> </span><span 
class="cmr-8">information</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7005r3"></a></span><span 
class="cmr-8">xC</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">linspace</span><span 
class="cmr-8">(</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">nC</span><span 
class="cmr-8">+1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7006r4"></a></span><span 
class="cmr-8">yC</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">zeros</span><span 
class="cmr-8">(</span><span 
class="cmr-8">size</span><span 
class="cmr-8">(</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">,1),</span><span 
class="cmr-8">K</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7007r5"></a></span><span 
class="cmr-8">deltaC</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">b</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">a</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><span 
class="cmr-8">/</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">nC</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7008r6"></a></span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[1,:]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">y0</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7009r7"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7010r8"></a></span><span 
class="cmr-8">#”</span><span 
class="cmr-8">coarse</span><span 
class="cmr-8"> </span><span 
class="cmr-8">integrator</span><span 
class="cmr-8"> </span><span 
class="cmr-8">partially</span><span 
class="cmr-8"> </span><span 
class="cmr-8">evaluated</span><span 
class="cmr-8">”</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7011r9"></a></span><span 
class="cmr-8">ciPEvaled</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">((</span><span 
class="cmr-8">x1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y1</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">−</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">coarseIntegrator</span><span 
class="cmr-8">(</span><span 
class="cmr-8">deltaC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">x1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7012r10"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7013r11"></a></span><span 
class="cmr-8">#</span><span 
class="cmr-8">get</span><span 
class="cmr-8"> </span><span 
class="cmr-8">initial</span><span 
class="cmr-8"> </span><span 
class="cmr-8">coarse</span><span 
class="cmr-8"> </span><span 
class="cmr-8">integration</span><span 
class="cmr-8"> </span><span 
class="cmr-8">solution</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7014r12"></a></span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">i</span><span 
class="cmr-8">=2:(</span><span 
class="cmr-8">nC</span><span 
class="cmr-8">+1)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7015r13"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,1]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">ciPEvaled</span><span 
class="cmr-8">(</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1],</span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1,1]);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7016r14"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7017r15"></a></span><span 
class="cmr-8">correctC</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">copy</span><span 
class="cmr-8">(</span><span 
class="cmr-8">yC</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7018r16"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7019r17"></a></span><span 
class="cmr-8">#</span><span 
class="cmr-8">initialize</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fine</span><span 
class="cmr-8"> </span><span 
class="cmr-8">information</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7020r18"></a></span><span 
class="cmr-8">xF</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">zeros</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7021r19"></a></span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">i</span><span 
class="cmr-8">=1:</span><span 
class="cmr-8">nC</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7022r20"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">xF</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,:]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">linspace</span><span 
class="cmr-8">(</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">],</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">+1],</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7023r21"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7024r22"></a></span><span 
class="cmr-8">sub</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">zeros</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">K</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7025r23"></a></span><span 
class="cmr-8">deltaF</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">xF</span><span 
class="cmr-8">[1,2]</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">−</span><span 
class="cmr-8"> </span><span 
class="cmr-8">xF</span><span 
class="cmr-8">[1,1];</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7026r24"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7027r25"></a></span><span 
class="cmr-8">#”</span><span 
class="cmr-8">fine</span><span 
class="cmr-8"> </span><span 
class="cmr-8">integrator</span><span 
class="cmr-8"> </span><span 
class="cmr-8">partially</span><span 
class="cmr-8"> </span><span 
class="cmr-8">evaluated</span><span 
class="cmr-8">”</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7028r26"></a></span><span 
class="cmr-8">fiPEvaled</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">((</span><span 
class="cmr-8">x1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y1</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">−</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fineIntegrator</span><span 
class="cmr-8">(</span><span 
class="cmr-8">deltaF</span><span 
class="cmr-8">,</span><span 
class="cmr-8">x1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7029r27"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7030r28"></a></span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">k</span><span 
class="cmr-8">=2:</span><span 
class="cmr-8">K</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7031r29"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">#</span><span 
class="cmr-8">run</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fine</span><span 
class="cmr-8"> </span><span 
class="cmr-8">integration</span><span 
class="cmr-8"> </span><span 
class="cmr-8">on</span><span 
class="cmr-8"> </span><span 
class="cmr-8">each</span><span 
class="cmr-8"> </span><span 
class="cmr-8">subdomain</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7032r30"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">tic</span><span 
class="cmr-8">();</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7033r31"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">@sync</span><span 
class="cmr-8"> </span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">i</span><span 
class="cmr-8">=1:</span><span 
class="cmr-8">nC</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7034r32"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,1,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">correctC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,</span><span 
class="cmr-8">k</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1];</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7035r33"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">@async</span><span 
class="cmr-8"> </span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">j</span><span 
class="cmr-8">=2:(</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7036r34"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,</span><span 
class="cmr-8">j</span><span 
class="cmr-8">,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fiPEvaled</span><span 
class="cmr-8">(</span><span 
class="cmr-8">xF</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,</span><span 
class="cmr-8">j</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1],</span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,</span><span 
class="cmr-8">j</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7037r35"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7038r36"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7039r37"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">toc</span><span 
class="cmr-8">();</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7040r38"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7041r39"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">#</span><span 
class="cmr-8">predict</span><span 
class="cmr-8"> </span><span 
class="cmr-8">and</span><span 
class="cmr-8"> </span><span 
class="cmr-8">correct</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7042r40"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">i</span><span 
class="cmr-8">=1:</span><span 
class="cmr-8">nC</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7043r41"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">ciPEvaled</span><span 
class="cmr-8">(</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">],</span><span 
class="cmr-8">correctC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7044r42"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">correctC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">−</span><span 
class="cmr-8"> </span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">k</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">,</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">];</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7045r43"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7046r44"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7047r45"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7048r46"></a></span><span 
class="cmr-8">yF</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">zeros</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nC</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1),</span><span 
class="cmr-8">K</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7049r47"></a></span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">k</span><span 
class="cmr-8">=2:</span><span 
class="cmr-8">K</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7050r48"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">yF</span><span 
class="cmr-8">[:,</span><span 
class="cmr-8">k</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">reshape</span><span 
class="cmr-8">(</span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[:,:,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">]&#x2019;,</span><span 
class="cmr-8">nC</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7051r49"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7052r50"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7053r51"></a></span><span 
class="cmr-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">reshape</span><span 
class="cmr-8">(</span><span 
class="cmr-8">xF</span><span 
class="cmr-8">&#x2019;,</span><span 
class="cmr-8">nC</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1)),</span><span 
class="cmr-8">reshape</span><span 
class="cmr-8">(</span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[:,:,</span><span 
class="cmr-8">K</span><span 
class="cmr-8">]&#x2019;,</span><span 
class="cmr-8">nC</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">(</span><span 
class="cmr-8">nF</span><span 
class="cmr-8">+1)),</span><span 
class="cmr-8">yF</span><span 
class="cmr-8">,</span><span 
class="cmr-8">sub</span><span 
class="cmr-8">,</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">correctC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">yC</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-7054r52"></a></span><span 
class="cmr-8">end</span>
                                                                            

                                                                            
   </div><hr class="endfloat" />
   </div>
<!--l. 461--><p class="indent" >   Listing <a 
href="#x1-7001r1">1<!--tex4ht:ref: lst:euler --></a> presents an implementation of the parareal algorithm (from the prior
section) in Julia. The <span 
class="cmtt-12">@async </span>macro within the loop causes the program to evaluate
the ﬁrst expression to its right as a concurrent task (i.e., the <span 
class="cmtt-12">for </span>loop assigning
values to <span 
class="cmtt-12">sub</span>). The <span 
class="cmtt-12">@sync </span>macro causes the main program thread to wait until all
tasks (spawned in the the ﬁrst expression to its right with an <span 
class="cmtt-12">@async </span>or <span 
class="cmtt-12">@parallel</span>
macro) complete. Once all concurrent tasks are complete, execution of
the program proceeds sequentially. Given the semantics of these macros,
the program in Listing <a 
href="#x1-7001r1">1<!--tex4ht:ref: lst:euler --></a> correctly perform concurrent integration. The
sequential and parallel versions of this implementation have no signiﬁcant
diﬀerences in run-time eﬃciency. However, if a <span 
class="cmtt-12">sleep </span>statement is placed in the
argument of <span 
class="cmtt-12">fineIntegrator</span>, the parallel version runs much faster. This
demonstrates that use of those two macros does lead to concurrent program
execution.
</p>
   <h3 class="likesectionHead"><a 
 id="x1-8000"></a>GRAPHICAL ALGORITHM SIMULATION</h3>
   <!--l. 479-->
                                                                            

                                                                            
<!--l. 480--><p class="indent" >   <a 
 id="x1-8001r2"></a></p><hr class="float" /><div class="float" 
>
                                                                            

                                                                            
<a 
 id="x1-8002"></a>
 <div class="caption" 
><span class="id">Listing 2: </span><span  
class="content">Implementation of a graphical simulator of the parareal algorithm
in Julia.</span></div><!--tex4ht:label?: x1-8001r --><div class="lstlisting" id="listing-6"><span class="label"><a 
 id="x1-8003r1"></a></span><span 
class="cmr-8">@everywhere</span><span 
class="cmr-8"> </span><span 
class="cmr-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fullMethod</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8">,</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">,</span><span 
class="cmr-8">integrator</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8004r2"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">#</span><span 
class="cmr-8">setup</span><span 
class="cmr-8"> </span><span 
class="cmr-8">domain</span><span 
class="cmr-8"> </span><span 
class="cmr-8">and</span><span 
class="cmr-8"> </span><span 
class="cmr-8">range</span><span 
class="cmr-8"> </span><span 
class="cmr-8">space</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8005r3"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">x</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">linspace</span><span 
class="cmr-8">(</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">n</span><span 
class="cmr-8">+1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8006r4"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">deltaX</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">x</span><span 
class="cmr-8">[2]</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">−</span><span 
class="cmr-8"> </span><span 
class="cmr-8">x</span><span 
class="cmr-8">[1];</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8007r5"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">y</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">ones</span><span 
class="cmr-8">(</span><span 
class="cmr-8">n</span><span 
class="cmr-8">+1,1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8008r6"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8009r7"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">#</span><span 
class="cmr-8">initialize</span><span 
class="cmr-8"> </span><span 
class="cmr-8">left</span><span 
class="cmr-8"> </span><span 
class="cmr-8">endpoint</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8010r8"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">y</span><span 
class="cmr-8">[1]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">y0</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8011r9"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8012r10"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">#</span><span 
class="cmr-8">integrate</span><span 
class="cmr-8"> </span><span 
class="cmr-8">each</span><span 
class="cmr-8"> </span><span 
class="cmr-8">point</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8013r11"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">i</span><span 
class="cmr-8">=1:</span><span 
class="cmr-8">n</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8014r12"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">y</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">+1]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">integrator</span><span 
class="cmr-8">(</span><span 
class="cmr-8">deltaX</span><span 
class="cmr-8">,</span><span 
class="cmr-8">x</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">],</span><span 
class="cmr-8">y</span><span 
class="cmr-8">[</span><span 
class="cmr-8">i</span><span 
class="cmr-8">],</span><span 
class="cmr-8">f</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8015r13"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8016r14"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">x</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8017r15"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8018r16"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8019r17"></a></span><span 
class="cmr-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">simulate</span><span 
class="cmr-8">(</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">N</span><span 
class="cmr-8">,</span><span 
class="cmr-8">M</span><span 
class="cmr-8">,</span><span 
class="cmr-8">K</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">,</span><span 
class="cmr-8">coarseInt</span><span 
class="cmr-8">,</span><span 
class="cmr-8">fineInt</span><span 
class="cmr-8">,</span><span 
class="cmr-8">showPrev</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8020r18"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">x1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y1</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fullMethod</span><span 
class="cmr-8">(</span><span 
class="cmr-8">N</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">(</span><span 
class="cmr-8">M</span><span 
class="cmr-8">+1),</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">,</span><span 
class="cmr-8">fineInt</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8021r19"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">x</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y</span><span 
class="cmr-8">,</span><span 
class="cmr-8">yF</span><span 
class="cmr-8">,</span><span 
class="cmr-8">sub</span><span 
class="cmr-8">,</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">yC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">iC</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">parareal</span><span 
class="cmr-8">(</span><span 
class="cmr-8">a</span><span 
class="cmr-8">,</span><span 
class="cmr-8">b</span><span 
class="cmr-8">,</span><span 
class="cmr-8">N</span><span 
class="cmr-8">,</span><span 
class="cmr-8">M</span><span 
class="cmr-8">,</span><span 
class="cmr-8">K</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">,</span><span 
class="cmr-8">coarseInt</span><span 
class="cmr-8">,</span><span 
class="cmr-8">fineInt</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8022r20"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">xF</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">reshape</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x</span><span 
class="cmr-8">,</span><span 
class="cmr-8">M</span><span 
class="cmr-8">+1,</span><span 
class="cmr-8">N</span><span 
class="cmr-8">))&#x2019;;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8023r21"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">fine</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">M</span><span 
class="cmr-8">+1;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8024r22"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">for</span><span 
class="cmr-8"> </span><span 
class="cmr-8">k</span><span 
class="cmr-8">=2:</span><span 
class="cmr-8">K</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8025r23"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">display</span><span 
class="cmr-8">(</span><span 
class="cmr-8">plot</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x1</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y1</span><span 
class="cmr-8">));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8026r24"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">if</span><span 
class="cmr-8">(</span><span 
class="cmr-8">showPrev</span><span 
class="cmr-8"> </span><span 
class="cmr-8">&#x0026;&#x0026;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">k</span><span 
class="cmr-8"> </span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">2</span><span 
class="cmr-8"> </span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8027r25"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">display</span><span 
class="cmr-8">(</span><span 
class="cmr-8">scatter</span><span 
class="cmr-8">!(</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[:,</span><span 
class="cmr-8">k</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">2],</span><span 
class="cmr-8">color</span><span 
class="cmr-8">=”</span><span 
class="cmr-8">red</span><span 
class="cmr-8">”,</span><span 
class="cmr-8">legend</span><span 
class="cmr-8">=</span><span 
class="cmr-8">false</span><span 
class="cmr-8">));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8028r26"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8029r27"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">display</span><span 
class="cmr-8">(</span><span 
class="cmr-8">scatter</span><span 
class="cmr-8">!(</span><span 
class="cmr-8">xC</span><span 
class="cmr-8">,</span><span 
class="cmr-8">yC</span><span 
class="cmr-8">[:,</span><span 
class="cmr-8">k</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1],</span><span 
class="cmr-8">color</span><span 
class="cmr-8">=”</span><span 
class="cmr-8">green</span><span 
class="cmr-8">”,</span><span 
class="cmr-8">legend</span><span 
class="cmr-8">=</span><span 
class="cmr-8">false</span><span 
class="cmr-8">));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8030r28"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">done</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">zeros</span><span 
class="cmr-8">(</span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">,</span><span 
class="cmr-8">N</span><span 
class="cmr-8">,1);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8031r29"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">workingSubdomains</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">1:</span><span 
class="cmr-8">N</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8032r30"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">while</span><span 
class="cmr-8">(</span><span 
class="cmr-8">done</span><span 
class="cmr-8"> </span><span 
class="cmr-8">!=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">M</span><span 
class="cmr-8">+1)</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">∗</span><span 
class="cmr-8"> </span><span 
class="cmr-8">ones</span><span 
class="cmr-8">(</span><span 
class="cmr-8">N</span><span 
class="cmr-8">,1)</span><span 
class="cmr-8"> </span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8033r31"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">index</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">(</span><span 
class="cmr-8">ceil</span><span 
class="cmr-8">(</span><span 
class="cmr-8">size</span><span 
class="cmr-8">(</span><span 
class="cmr-8">workingSubdomains</span><span 
class="cmr-8">,1)</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">rand</span><span 
class="cmr-8">()));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8034r32"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">currThread</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">workingSubdomains</span><span 
class="cmr-8">[</span><span 
class="cmr-8">index</span><span 
class="cmr-8">];</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8035r33"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">while</span><span 
class="cmr-8">(</span><span 
class="cmr-8"> </span><span 
class="cmr-8">done</span><span 
class="cmr-8">[</span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">==</span><span 
class="cmr-8"> </span><span 
class="cmr-8">M</span><span 
class="cmr-8">+1</span><span 
class="cmr-8"> </span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8036r34"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">currThread</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">(</span><span 
class="cmr-8">ceil</span><span 
class="cmr-8">(</span><span 
class="cmr-8">N</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">∗</span><span 
class="cmr-8"> </span><span 
class="cmr-8">rand</span><span 
class="cmr-8">()));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8037r35"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8038r36"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">currThreadPlot</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Int64</span><span 
class="cmr-8">(</span><span 
class="cmr-8">ceil</span><span 
class="cmr-8">(</span><span 
class="cmr-8">fine</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">rand</span><span 
class="cmr-8">()));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8039r37"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">totalAdvance</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">done</span><span 
class="cmr-8">[</span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">currThreadPlot</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8040r38"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">if</span><span 
class="cmr-8">(</span><span 
class="cmr-8">totalAdvance</span><span 
class="cmr-8"> </span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fine</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><span 
class="cmr-8">totalAdvance</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">fine</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8041r39"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">newP</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">done</span><span 
class="cmr-8">[</span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">]+1):</span><span 
class="cmr-8">totalAdvance</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8042r40"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">display</span><span 
class="cmr-8">(</span><span 
class="cmr-8">plot</span><span 
class="cmr-8">!(</span><span 
class="cmr-8">xF</span><span 
class="cmr-8">[</span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">,</span><span 
class="cmr-8">newP</span><span 
class="cmr-8">],</span><span 
class="cmr-8">sub</span><span 
class="cmr-8">[</span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">,</span><span 
class="cmr-8">newP</span><span 
class="cmr-8">,</span><span 
class="cmr-8">k</span><span 
class="cmr-8">],</span><span 
class="cmr-8">color</span><span 
class="cmr-8">=”</span><span 
class="cmr-8">black</span><span 
class="cmr-8">”));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8043r41"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">done</span><span 
class="cmr-8">[</span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">]</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">totalAdvance</span><span 
class="cmr-8">;</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8044r42"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">workingSubdomains</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">find</span><span 
class="cmr-8">(</span><span 
class="cmr-8"> </span><span 
class="cmr-8">((</span><span 
class="cmr-8">x</span><span 
class="cmr-8">)</span><span 
class="cmsy-8">−</span><span 
class="cmmi-8">&#x003E;</span><span 
class="cmr-8">x</span><span 
class="cmr-8"> </span><span 
class="cmr-8">!=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">M</span><span 
class="cmr-8">+1),</span><span 
class="cmr-8"> </span><span 
class="cmr-8">done</span><span 
class="cmr-8"> </span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8045r43"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">print</span><span 
class="cmr-8">(</span><span 
class="cmr-8">join</span><span 
class="cmr-8">([”</span><span 
class="cmr-8">Working</span><span 
class="cmr-8"> </span><span 
class="cmr-8">on</span><span 
class="cmr-8"> </span><span 
class="cmr-8">subdomain</span><span 
class="cmr-8"> </span><span 
class="cmr-8">#”,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">currThread</span><span 
class="cmr-8">,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">”...”,</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8046r44"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">”</span><span 
class="cmr-8">Pending</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Subdomains</span><span 
class="cmr-8">:</span><span 
class="cmr-8"> </span><span 
class="cmr-8">”,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">workingSubdomains</span><span 
class="cmr-8">&#x2019;,</span><span 
class="cmr-8"> </span><span 
class="cmr-8">”</span><span 
class="cmsy-8">∖</span><span 
class="cmr-8">n</span><span 
class="cmr-8">”]));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8047r45"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8048r46"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">display</span><span 
class="cmr-8">(</span><span 
class="cmr-8">plot</span><span 
class="cmr-8">!(</span><span 
class="cmr-8">x</span><span 
class="cmr-8">,</span><span 
class="cmr-8">yF</span><span 
class="cmr-8">[:,</span><span 
class="cmr-8">k</span><span 
class="cmsy-8">−</span><span 
class="cmr-8">1],</span><span 
class="cmr-8">color</span><span 
class="cmr-8">=”</span><span 
class="cmr-8">orange</span><span 
class="cmr-8">”));</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8049r47"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">sleep</span><span 
class="cmr-8">(5);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8050r48"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8051r49"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8052r50"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8053r51"></a></span><span 
class="cmr-8">#</span><span 
class="cmr-8"> </span><span 
class="cmr-8">Implementation</span><span 
class="cmr-8"> </span><span 
class="cmr-8">schemes</span><span 
class="cmr-8">.</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8054r52"></a></span><span 
class="cmr-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">euler</span><span 
class="cmr-8">(</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">,</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8055r53"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">y0</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">delta</span><span 
class="cmr-8"> </span><span 
class="cmsy-8">∗</span><span 
class="cmr-8"> </span><span 
class="cmr-8">f</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8056r54"></a></span><span 
class="cmr-8">end</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8057r55"></a></span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8058r56"></a></span><span 
class="cmr-8">function</span><span 
class="cmr-8"> </span><span 
class="cmr-8">rungeKutta</span><span 
class="cmr-8">(</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">,</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">f</span><span 
class="cmr-8">)</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8059r57"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">k1</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">f</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8060r58"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">k2</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">f</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">+</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">/2,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">/2)</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">k1</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8061r59"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">k3</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">f</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">+</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">/2,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">/2)</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">k2</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8062r60"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">k4</span><span 
class="cmr-8"> </span><span 
class="cmr-8">=</span><span 
class="cmr-8"> </span><span 
class="cmr-8">f</span><span 
class="cmr-8">(</span><span 
class="cmr-8">x0</span><span 
class="cmr-8">+</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">,</span><span 
class="cmr-8">y0</span><span 
class="cmr-8">+</span><span 
class="cmr-8">delta</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">k3</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8063r61"></a></span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8"> </span><span 
class="cmr-8">return</span><span 
class="cmr-8"> </span><span 
class="cmr-8">y0</span><span 
class="cmr-8"> </span><span 
class="cmr-8">+</span><span 
class="cmr-8"> </span><span 
class="cmr-8">(</span><span 
class="cmr-8">delta</span><span 
class="cmr-8">/6)</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">(</span><span 
class="cmr-8">k1</span><span 
class="cmr-8">+2</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">k2</span><span 
class="cmr-8">+2</span><span 
class="cmsy-8">∗</span><span 
class="cmr-8">k3</span><span 
class="cmr-8">+</span><span 
class="cmr-8">k4</span><span 
class="cmr-8">);</span><span 
class="cmr-8"> </span><br /><span class="label"><a 
 id="x1-8064r62"></a></span><span 
class="cmr-8">end</span>
                                                                            

                                                                            
   </div><hr class="endfloat" />
   </div>
   <hr class="figure" /><div class="figure" 
>
                                                                            

                                                                            
<a 
 id="x1-80652"></a>
                                                                            

                                                                            
<!--l. 548--><p class="noindent" > <!--tex4ht:inline--></p><div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1" /><col 
id="TBL-2-2" /></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="text-align:center; white-space:nowrap;" id="TBL-2-1-1"  
class="td11"><img 
src="sin1.png" alt="PIC"  
 /></td><td  style="text-align:center; white-space:nowrap;" id="TBL-2-1-2"  
class="td11"><img 
src="sin2.png" alt="PIC"  
 /></td></tr></table>                                                                                    </div>
<br /> <div class="caption" 
><span class="id">Figure 2:  </span><span  
class="content">Slow  parareal  example.  (left)  Solution  after  ﬁrst  iteration  with
Euler&#x2019;s method. (right) Solution after ninth iteration with Euler&#x2019;s method.</span></div><!--tex4ht:label?: x1-80652 -->
                                                                            

                                                                            
   </div><hr class="endfigure" />
<!--l. 559--><p class="indent" >   The function <span 
class="cmtt-12">simulate </span>in Listing <a 
href="#x1-8001r2">2<!--tex4ht:ref: lst:simulate --></a> creates a graphical simulator
of the parareal algorithm. This function can be used to introduce the
parareal algorithm to students in a numerical analysis course. The ﬁrst
line gets the sequential solution from the ﬁne integrator (the ‘ideal&#x2019;
solution) and the second line gets the history of the computations that
took place during the parareal execution. The main loop over the variable
<!--l. 566--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math> then
displays the inner workings of the algorithm. The ideal solution is plotted, with a
scatter plot of the points obtained from the coarse integrator. To simulate the
parallel nature of the algorithm, random progress is made on randomly selected
subdomains. Thus, the plot dynamically makes partial progress on diﬀerent
subdomains until all subdomains are ﬁnished with the ﬁne integration. After this,
the plots are connected into the current iteration&#x2019;s approximation. During the next
iteration, the previous guesses from the coarse integrator are displayed in red
and the new guesses from the coarse integrator are displayed in green. As
<!--l. 574--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>
increases, these guesses converge to the ideal solution.
</p><!--l. 577--><p class="indent" >   In addition to the use of this function for pedagogical purposes, it can be used
to investigate the types of curves for which the parareal algorithm might be
practical. For instance, consider the diﬀerential equation
</p>
   <table class="equation-star"><tr><td>
<!--l. 581--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <msup><mrow 
><mi 
>y</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>s</mi><mi 
>i</mi><mi 
>n</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>x</mi><mi 
>y</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">,</mo><mspace width="1em" class="quad"/><mi 
>x</mi> <mo 
class="MathClass-rel">∈</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>2</mn><mn>0</mn><mo 
class="MathClass-punc">,</mo> <mn>2</mn><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow>
</math></td></tr></table>
<!--l. 583--><p class="noindent" >with <!--l. 583--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>y</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mo 
class="MathClass-bin">−</mo><mn>2</mn><mn>0</mn></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>0</mn></math>,
<!--l. 583--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Δ</mi> <mo 
class="MathClass-rel">=</mo> <mn>4</mn></math> (10 points),
and <!--l. 583--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>δ</mi> <mo 
class="MathClass-rel">=</mo> <mn>0</mn><mo 
class="MathClass-punc">.</mo><mn>0</mn><mn>0</mn><mn>8</mn></math> (500
points). Figure <a 
href="#x1-80652">2<!--tex4ht:ref: sinPara --></a> shows the ﬁrst and ninth iterations. The ninth iteration&#x2019;s large
error on the right end of the interval shows that this is an example where parareal
                                                                            

                                                                            
convergence is slow. This is as ineﬃcient as possible, needing as many iterations as
subdomains in order for the solution to converge. However, the simulation also shows
that if <!--l. 588--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>f</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mi 
>s</mi><mi 
>i</mi><mi 
>n</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>x</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><msup><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>x</mi></mrow></msup 
></math>,
then the solution converges after just one iteration. These two examples show that
the algorithm&#x2019;s eﬃciency can be highly dependent on the integrand. Below the
simulation function are <span 
class="cmti-12">Euler&#x2019;s method </span>and another <span 
class="cmti-12">Runge-Kutta </span>integration technique
that can be used as examples to be passed as ﬁrst-class functions as coarse or ﬁne
integration techniques to the <span 
class="cmtt-12">parareal </span>or <span 
class="cmtt-12">simulate </span>functions. A Git repository of
both the implementation and graphical simulation is available in GitHub at
<a 
href="https://github.com/sperugin/Parareal-Implementation-and-Simulation-in-Julia.git" class="url" ><span 
class="cmtt-12">https://github.com/sperugin/Parareal-Implementation-and-Simulation-in-Julia.git</span></a>.
All of the graphical plots are generated with the Julia Plots package available at
<a 
href="https://juliaplots.github.io/" class="url" ><span 
class="cmtt-12">https://juliaplots.github.io/</span></a>. A video describing this application of Julia is
available on YouTube at <a 
href="https://www.youtube.com/watch?v=MtgbeLO6ZM4" class="url" ><span 
class="cmtt-12">https://www.youtube.com/watch?v=MtgbeLO6ZM4</span></a>.
</p>
   <h3 class="likesectionHead"><a 
 id="x1-9000"></a>REFERENCES</h3>
<!--l. 602--><p class="noindent" >
   </p><div class="thebibliography">
   <p class="bibitem" ><span class="biblabel">
 [1]<span class="bibsp">   </span></span><a 
 id="Xwebsite"></a>High performance JIT compiler.   Available: <a 
href="http://julialang.org" class="url" ><span 
class="cmtt-12">http://julialang.org</span></a>
   [Last accessed: 24 April 2017].
   </p>
   <p class="bibitem" ><span class="biblabel">
 [2]<span class="bibsp">   </span></span><a 
 id="XJuliaParallelComputingMan"></a>Julia     documentation:     Parallel     computing.             Available:
   <a 
href="https://docs.julialang.org/en/stable/manual/parallel-computing/\#Parallel-Computing-1" class="url" ><span 
class="cmtt-12">https://docs.julialang.org/en/stable/manual/parallel-computing/\#Parallel-Computing-1</span></a>
   [Last accessed: 22 May 2018].
   </p>
   <p class="bibitem" ><span class="biblabel">
 [3]<span class="bibsp">   </span></span><a 
 id="XAubanel"></a>Aubanel, E.  Scheduling of tasks in the parareal algorithm.  <span 
class="cmti-12">Parallel</span>
   <span 
class="cmti-12">Computing</span>, 37(3):172–182, 2011.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [4]<span class="bibsp">   </span></span><a 
 id="XOperators:Julia"></a>Bezanson,  J.,  Chen,  J.,  Karpinski,  S.,  Shah,  V.,  and  Edelman,  A.
   Array operators using multiple dispatch: A design methodology for array
                                                                            

                                                                            
   implementations in dynamic languages. In <span 
class="cmti-12">Proceedings of ACM SIGPLAN</span>
   <span 
class="cmti-12">International Workshop on Libraries, Languages, and Compilers for Array</span>
   <span 
class="cmti-12">Programming</span>, pages 56–61, New York, NY, 2014. ACM Press.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [5]<span class="bibsp">   </span></span><a 
 id="XPPPP:Julia"></a>Chen,  J.  and  Edelman,  A.    Parallel  preﬁx  polymorphism  permits
   parallelization,  presentation  and  proof.    In  <span 
class="cmti-12">Proceedings  of  the  First</span>
   <span 
class="cmti-12">Workshop  for  High  Performance  Technical  Computing  in  Dynamic</span>
   <span 
class="cmti-12">Languages (HPTCDL)</span>, pages 47–56, Piscataway, NJ, USA, 2014. IEEE
   Press.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [6]<span class="bibsp">   </span></span><a 
 id="XGander"></a>Gander, M. and Vandewalle, S.  Analysis of the parareal time-parallel
   time-integration  method.     <span 
class="cmti-12">SIAM  Journal  on  Scientiﬁc  Computing</span>,
   29(2):556–578, 2007.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [7]<span class="bibsp">   </span></span><a 
 id="XLionsEtAl"></a>Lions,  J.-L.,  Maday,  Y.,  and  Turinici,  G.    A  “parareal”  in  time
   discretization of pde&#x2019;s.   <span 
class="cmti-12">Comptes Rendus de l&#x2019;Acad</span><span 
class="cmti-12">é</span><span 
class="cmti-12">mie des Sciences -</span>
   <span 
class="cmti-12">Series I - Mathematics</span>, 332:661–668, 2001.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [8]<span class="bibsp">   </span></span><a 
 id="XJulia"></a>Moﬃt, J. and Tate, B.  Julia.  In Tate, B., Daoud, F., Dees, I., and
   Moﬃt, J., editors, <span 
class="cmti-12">Seven more languages in seven weeks: Languages that</span>
   <span 
class="cmti-12">are shaping the future</span>, chapter 5, pages 171–207. Pragmatic Bookshelf,
   Dallas, TX, 2014.
   </p>
   <p class="bibitem" ><span class="biblabel">
 [9]<span class="bibsp">   </span></span><a 
 id="XNielsen"></a>Nielsen, A. Feasibility study of the parareal algorithm. Master&#x2019;s thesis,
   Technical University of Denmark, 2012.
</p>
   </div>
    
</body></html> 

                                                                            


